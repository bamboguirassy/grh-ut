<!--<div class="add-action-box" *ngIf="structureFonctionSrv.resourceName|creable">
  <button tc-button [afterIcon]="'icofont-plus'" [view]="'accent'" [square]="true" [tcShape]="500"
    (click)="openModal()"></button>
</div>-->
<app-access-denied *ngIf="!(structureFonctionSrv.resourceName|creable)"></app-access-denied>

<form #form="ngForm" ngNativeValidate>
  <div class="row">
    <div class="col-12 col-md-12">
      <tc-form-group>
        <tc-form-label>Rangs</tc-form-label>
        <nz-select (ngModelChange)="onFonctionSelected($event)" style="width: 100%;"
          (nzOpenChange)="fetchNotBindedFonctions()" nzMode="default" [nzAllowClear]="true" [nzShowSearch]="true"
          name="rangs" nzPlaceHolder="Selectionner le poste principal" [(ngModel)]="selectedRangs">
          <ng-container *ngFor="let rang of rangs">
            <nz-option *ngIf="!fetching" [nzLabel]="rang?.nom" [nzValue]="rang">
            </nz-option>
          </ng-container>
          <nz-option *ngIf="fetching" nzDisabled nzCustomContent>
            <i nz-icon nzType="loading" class="loading-icon"></i> Veuillez patienter...
          </nz-option>
        </nz-select>
      </tc-form-group>
    </div>
  </div>
</form>

<tc-table *ngIf="structureFonctions?.length" [itemsPerPage]="10" [rows]="structureFonctions" [hovered]="true"
  [pagination]="true" [search]="false">
  <tc-table-col [columnTitle]="'Rang'" [columnName]="'rang'" [enableSorting]="true">
    <ng-template #tableTDTemplate let-value let-row>
      <i class="icofont-stamp icofont-2x"></i> &nbsp;
      <span class="nowrap">{{ value?.nom }}</span>
    </ng-template>
  </tc-table-col>
  <tc-table-col [columnTitle]="'Etat'" [columnName]="'etat'" [enableSorting]="true">
    <ng-template #tableTDTemplate let-value let-row="row">
      <tc-switcher [(ngModel)]="row.etat" name="etat" id="etat" #etat="ngModel"
        [bgColor]="['transparent', 'transparent', '#ed5564']" [borderColor]="['#ed5564', '#ed5564', '#ed5564']"
        [color]="['#ed5564', '#ed5564', '#fff']">
      </tc-switcher>
    </ng-template>
  </tc-table-col>
  <tc-table-col [columnTitle]="'Durée limitée'" [columnName]="'dl'" style="white-space: nowrap;" [enableSorting]="true">
    <ng-template #tableTDTemplate let-value let-row >
      <nz-radio-group [(ngModel)]="isLimited" class="mb-2">
        <label nz-radio [nzValue]="true">Oui</label>
        <label nz-radio [nzValue]="false">Non</label>
      </nz-radio-group>
      <tc-input *ngIf="isLimited" type="number" style="width: 50%;" [(ngModel)]="duree"  name="dureeEnMois"
        aria-placeholder="Durée en nombre de mois" id="dureeEnMois" #dureeEnMois="ngModel">
      </tc-input>
      <small *ngIf="isLimited">Saisir le nombre de mois</small>
    </ng-template>
  </tc-table-col>
</tc-table>


<div class="row d-flex justify-content-end mt-2" *ngIf="structureFonctions?.length">
  <div class="col-2 col-sm-2 col-lg-2">
    <button [disabled]="form.invalid" [disabled]="form.invalid" (click)="save()" [afterIcon]="'icofont-save'" tc-button
      [view]="'accent'">
      Enregistrer
    </button>
  </div>

</div>