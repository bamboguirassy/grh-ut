<tc-card *ngIf="typeDocumentSrv.resourceName | listable" [tcGradient]="lightGradient">
  <tc-card [view]="secondViewBorder" [outline]="true">
    <div class="row">
      <div class="col-12">
        <button class="float-right" tc-button afterIcon="icofont-refresh" (click)="findAll()">
          Rafraichir
        </button>
      </div>
    </div>
  </tc-card>
  <tc-table [itemsPerPage]="10" [rows]="items" [hovered]="true" [pagination]="true" [search]="true">
    <tc-table-col [columnTitle]="'Actions'" [columnName]="'actions'">
      <ng-template #tableTDTemplate let-row="row">
        <div class="actions">
          <button *ngIf="typeDocumentSrv.resourceName | editable" tc-button [afterIcon]="'icofont-ui-edit'"
            [view]="'warning'" [square]="true" [tcShape]="500" [size]="'sm'" [routerLink]="[row.id, 'edit']"></button>
          <button *ngIf="typeDocumentSrv.resourceName | deletable" (click)="remove(row)" tc-button
            [afterIcon]="'icofont-ui-delete'" [view]="'error'" [square]="true" [tcShape]="500" [size]="'sm'"></button>
          <button *ngIf="typeDocumentSrv.resourceName | showable" tc-button [afterIcon]="'icofont-eye-open'"
            [view]="'accent'" [square]="true" [tcShape]="500" [size]="'sm'" [routerLink]="[row.id]"></button>
        </div>
      </ng-template>
    </tc-table-col>
    <tc-table-col [columnTitle]="'#'" [columnName]="'#'">
      <ng-template #tableTDTemplate let-row="row">
        <i class="icofont-file-document icofont-2x"></i>
      </ng-template>
    </tc-table-col>
    <tc-table-col [columnTitle]="'Nom'" [columnName]="'nom'" [enableSorting]="true">
      <ng-template #tableTDTemplate let-row="row">
        <span class="nowrap" *ngIf="row.nom">{{ row.nom }}</span>
        <tc-badge view="error" *ngIf="!row.nom">Indéfinie</tc-badge>
      </ng-template>
    </tc-table-col>
    <tc-table-col [columnTitle]="'Durée Archivage'" [columnName]="'dureeArchivage'" [enableSorting]="true">
      <ng-template #tableTDTemplate let-row="row">        
        <ng-container *ngIf="!row.editEnabled">          
          <span class="nowrap" *ngIf="row.dureeArchivage">{{ row?.dureeArchivage }} an(s)  </span>
          <tc-badge view="error" *ngIf="!row.dureeArchivage">Indéfinie</tc-badge>
          <i (click)="enabledEdit(row)" class="icofont-ui-edit"
            *ngIf="typeDocumentSrv.resourceName | editable"></i>
        </ng-container>
        <ng-container *ngIf="row.editEnabled">
            <tc-input required="required" [(ngModel)]="row.dureeArchivage" name="dureeArchivage" id="dureeArchivage"
              #dureeArchivage="ngModel" suffix="an(s)">
            </tc-input>
            <tc-form-description>
              <app-form-field-validation-message [formField]="dureeArchivage"></app-form-field-validation-message>
            </tc-form-description>
          <hr class="m-1">
                    <button (click)="updateDureeArchivage(row)" tc-button
                        [afterIcon]="'icofont-save'" [view]="'accent'" [square]="true" [tcShape]="500"
                        [size]="'sm'"></button>
                    <button class="ml-1" (click)="disableEdit(row)" tc-button [afterIcon]="'icofont-close'"
                        [view]="'error'" [square]="true" [tcShape]="500" [size]="'sm'"></button>
        </ng-container>
        
      </ng-template>
    </tc-table-col>
    <tc-table-col [columnTitle]="'Description'" [columnName]="'description'" [enableSorting]="true">
      <ng-template #tableTDTemplate let-row="row">
        <div *ngIf="row?.description" [innerHTML]="row.description">{{ row?.description }}</div>
        <tc-badge view="error" *ngIf="!row.description">Indéfinie</tc-badge>
      </ng-template>
    </tc-table-col>    
  </tc-table>
  <app-empty-table-message *ngIf="!items.length"></app-empty-table-message>
  <app-typedocument-new (creation)="onCreate($event)"></app-typedocument-new>
</tc-card>
<app-access-denied *ngIf="!(typeDocumentSrv.resourceName | listable)"></app-access-denied>